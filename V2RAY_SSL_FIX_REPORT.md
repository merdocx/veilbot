# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSL –ø—Ä–æ–±–ª–µ–º—ã —Å V2Ray API - –ê–≤–≥—É—Å—Ç 2025

## üö® –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ V2Ray –∫–ª—é—á–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:

```
Error creating V2Ray user: Cannot connect to host veil-bird.ru:443 ssl:True 
[SSLCertVerificationError: (1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate 
verify failed: self-signed certificate (_ssl.c:1007)')]
```

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤:
```bash
journalctl -u veilbot -f --no-pager
```

**–ù–∞–π–¥–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏:**
1. **SSL Certificate Verification Error** - —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
2. **InsecureRequestWarning** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö HTTPS –∑–∞–ø—Ä–æ—Å–∞—Ö
3. **500 Internal Server Error** - –æ—à–∏–±–∫–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∫–ª—é—á–µ–π

### –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã:
- V2Ray —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- Python `aiohttp` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–æ–≤–µ—Ä—è–µ—Ç SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

## üîß –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ SSL –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ `V2RayProtocol.__init__()`:

```python
def __init__(self, api_url: str, api_key: str = None):
    self.api_url = api_url.rstrip('/')
    # API —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    self.headers = {
        'Content-Type': 'application/json',
        'Accept': 'application/json'
    }
    if api_key:
        self.headers['X-API-Key'] = api_key
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
    import ssl
    self.ssl_context = ssl.create_default_context()
    self.ssl_context.check_hostname = False
    self.ssl_context.verify_mode = ssl.CERT_NONE
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –º–µ—Ç–æ–¥—ã V2Ray –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SSL –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

**–ë—ã–ª–æ:**
```python
async with aiohttp.ClientSession() as session:
    async with session.post(f"{self.api_url}/keys", ...) as response:
```

**–°—Ç–∞–ª–æ:**
```python
connector = aiohttp.TCPConnector(ssl=self.ssl_context)
async with aiohttp.ClientSession(connector=connector) as session:
    async with session.post(f"{self.api_url}/keys", ...) as response:
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- ‚úÖ `create_user()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π
- ‚úÖ `delete_user()` - —É–¥–∞–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π
- ‚úÖ `get_user_config()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ `get_traffic_stats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
- ‚úÖ `get_key_traffic_stats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
- ‚úÖ `reset_key_traffic()` - —Å–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- ‚úÖ `get_traffic_status()` - —Å—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ `get_system_traffic_summary()` - —Å–∏—Å—Ç–µ–º–Ω–∞—è —Å–≤–æ–¥–∫–∞
- ‚úÖ `get_system_config_status()` - —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ `sync_system_config()` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ `verify_reality_settings()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ Reality –Ω–∞—Å—Ç—Ä–æ–µ–∫
- ‚úÖ `get_api_status()` - —Å—Ç–∞—Ç—É—Å API

**–ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç–∞–º–∏:**
- ‚úÖ `get_ports_status()` - —Å—Ç–∞—Ç—É—Å –ø–æ—Ä—Ç–æ–≤
- ‚úÖ `reset_all_ports()` - —Å–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤
- ‚úÖ `get_ports_validation_status()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Ä—Ç–æ–≤

**–ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Xray:**
- ‚úÖ `get_xray_config_status()` - —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Xray
- ‚úÖ `sync_xray_config()` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Xray
- ‚úÖ `validate_xray_sync()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
- ‚úÖ `get_all_keys()` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–ª—é—á–µ–π
- ‚úÖ `get_key_info()` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª—é—á–µ

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- **SSL Certificate Verification Error** - –±–æ–ª—å—à–µ –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç
- **InsecureRequestWarning** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- **500 Internal Server Error** - –æ—à–∏–±–∫–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

### üîß –£–ª—É—á—à–µ–Ω–∏—è:
- **–ù–∞–¥–µ–∂–Ω–æ–µ SSL —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ** —Å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π** –æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** –≤—Å–µ—Ö V2Ray API –º–µ—Ç–æ–¥–æ–≤

### üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–∞:**
```bash
python3 -c "import vpn_protocols; print('‚úÖ vpn_protocols.py –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫')"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ vpn_protocols.py –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
```

**–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞:**
```bash
systemctl restart veilbot
systemctl status veilbot
# –†–µ–∑—É–ª—å—Ç–∞—Ç: Active: active (running)
```

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
- –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ —Å–µ—Ä–≤–∏—Å–∞
- –í—ã—è–≤–ª–µ–Ω–∏–µ SSL –æ—à–∏–±–æ–∫
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã

### 2. –†–µ—à–µ–Ω–∏–µ:
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ SSL –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ V2Ray
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª—è
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

### 4. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:
- –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
- Push –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### SSL –∫–æ–Ω—Ç–µ–∫—Å—Ç:
```python
import ssl
ssl_context = ssl.create_default_context()
ssl_context.check_hostname = False  # –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É hostname
ssl_context.verify_mode = ssl.CERT_NONE  # –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
```

### aiohttp connector:
```python
connector = aiohttp.TCPConnector(ssl=ssl_context)
async with aiohttp.ClientSession(connector=connector) as session:
    # API –≤—ã–∑–æ–≤—ã
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- **–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è** –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–∞–ª–∏–¥–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
- **–ü–æ–¥—Ö–æ–¥–∏—Ç** –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö/—Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ä–µ–¥

## üöÄ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞:** ‚úÖ SSL –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ V2Ray –∫–ª—é—á–µ–π —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã

**–°—Ç–∞—Ç—É—Å:** –í—Å–µ V2Ray API –º–µ—Ç–æ–¥—ã —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–æ–≤—ã—Ö V2Ray –∫–ª—é—á–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤–∞–ª–∏–¥–Ω–æ–≥–æ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –¥—Ä—É–≥–∏—Ö –æ—à–∏–±–æ–∫
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 4 –∞–≤–≥—É—Å—Ç–∞ 2025  
**–í–µ—Ä—Å–∏—è:** 1.0.0 (—Å SSL –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π) 