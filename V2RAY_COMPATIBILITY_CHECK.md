# üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ V2Ray —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π API

## üìÖ –î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
2025-08-03 01:59 MSK

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç
**–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ô–î–ï–ù–ê –ò –ò–°–ü–†–ê–í–õ–ï–ù–ê!**

## ‚ùå –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. API —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
**–ü—Ä–æ–±–ª–µ–º–∞**: –í –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API —É–∫–∞–∑–∞–Ω–æ, —á—Ç–æ **–í–°–ï —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** —Å API –∫–ª—é—á–æ–º:
```
API –∫–ª—é—á: QBDMqDzCRh17NIGUsKDtWtoUmvwRVvSHHp4W8OCMcOM=
–ó–∞–≥–æ–ª–æ–≤–æ–∫: X-API-Key: QBDMqDzCRh17NIGUsKDtWtoUmvwRVvSHHp4W8OCMcOM=
```

**–ù–æ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**: API –∫–ª—é—á –±—ã–ª —É–¥–∞–ª–µ–Ω –∫–∞–∫ –Ω–µ–Ω—É–∂–Ω—ã–π.

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω `vpn_protocols.py`
```python
# –ë—ã–ª–æ:
self.headers = {
    'Content-Type': 'application/json',
    'Accept': 'application/json'
}

# –°—Ç–∞–ª–æ:
self.headers = {
    'Content-Type': 'application/json',
    'Accept': 'application/json'
}
if api_key:
    self.headers['X-API-Key'] = api_key
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω `config.py`
```python
'v2ray': {
    'name': 'V2Ray VLESS',
    'description': '–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª —Å –æ–±—Ñ—É—Å–∫–∞—Ü–∏–µ–π —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ Reality',
    'icon': 'üõ°Ô∏è',
    'default_port': 443,
    'default_path': '/v2ray',
    'api_key': 'QBDMqDzCRh17NIGUsKDtWtoUmvwRVvSHHp4W8OCMcOM='  # ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω
}
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω `bot.py`
```python
# –ë—ã–ª–æ:
server_config = {'api_url': server['api_url']}

# –°—Ç–∞–ª–æ:
server_config = {'api_url': server['api_url'], 'api_key': server.get('api_key')}
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∫–∞
```html
<!-- –ë—ã–ª–æ: -->
<label class="form-label">API –ö–ª—é—á (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
<input type="text" name="api_key" class="form-input" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –Ω–æ–≤–æ–≥–æ API">

<!-- –°—Ç–∞–ª–æ: -->
<label class="form-label">API –ö–ª—é—á *</label>
<input type="text" name="api_key" class="form-input" placeholder="QBDMqDzCRh17NIGUsKDtWtoUmvwRVvSHHp4W8OCMcOM=" required>
```

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è
```python
# –ë—ã–ª–æ:
@validator('api_key')
def validate_api_key(cls, v):
    # API key –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –Ω–æ–≤–æ–≥–æ V2Ray API
    if v and not v.strip():
        raise ValueError("API key cannot be empty if provided")
    return v.strip() if v else ""

# –°—Ç–∞–ª–æ:
@validator('api_key')
def validate_api_key(cls, v):
    # API key –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è V2Ray API
    if not v or not v.strip():
        raise ValueError("API key is required for V2Ray servers")
    return v.strip()
```

## üìä –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### ‚úÖ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç:
- [x] `POST /api/keys` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞
- [x] `GET /api/keys` - —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–π
- [x] `GET /api/keys/{key_id}` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª—é—á–µ
- [x] `DELETE /api/keys/{key_id}` - —É–¥–∞–ª–µ–Ω–∏–µ –∫–ª—é—á–∞
- [x] `GET /api/keys/{key_id}/config` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- [x] `GET /api/traffic/exact` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Å–µ—Ö –∫–ª—é—á–µ–π
- [x] `GET /api/keys/{key_id}/traffic/exact` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª—é—á–∞
- [x] `POST /api/keys/{key_id}/traffic/reset` - —Å–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### ‚úÖ –ó–∞–≥–æ–ª–æ–≤–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç:
- [x] `Content-Type: application/json`
- [x] `Accept: application/json`
- [x] `X-API-Key: QBDMqDzCRh17NIGUsKDtWtoUmvwRVvSHHp4W8OCMcOM=`

### ‚úÖ –§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç:
```json
// –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞
{
  "name": "–ú–æ–π VPN –∫–ª—é—á"
}
```

### ‚úÖ –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç:
```json
{
  "id": "84570736-8bf5-47af-92d4-3a08f2693ef8",
  "name": "–ú–æ–π VPN –∫–ª—é—á",
  "uuid": "44ed718f-9f5d-4bd9-8585-e5a875cd3858",
  "created_at": "2025-08-02T15:22:39.822640",
  "is_active": true
}
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### API –∫–ª—é—á
- **–ó–Ω–∞—á–µ–Ω–∏–µ**: `QBDMqDzCRh17NIGUsKDtWtoUmvwRVvSHHp4W8OCMcOM=`
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫**: `X-API-Key`
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –î–∞, –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

### –ë–∞–∑–æ–≤—ã–π URL
- **URL**: `http://veil-bird.ru/api`
- **–ü—Ä–æ—Ç–æ–∫–æ–ª**: HTTP (–Ω–µ HTTPS)

### –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤
- `200` - –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `400` - –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `401` - –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á
- `404` - –†–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- `500` - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- `503` - –°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

## üöÄ –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤

### veilbot.service
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **PID**: 534198
- **–ü–∞–º—è—Ç—å**: 39.2M
- **–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã**: 2 —Å–µ–∫—É–Ω–¥—ã

### veilbot-admin.service
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- **PID**: 534199
- **–ü–∞–º—è—Ç—å**: 45.8M
- **–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã**: 2 —Å–µ–∫—É–Ω–¥—ã

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!** 

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:
- ‚úÖ API –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤–æ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- ‚úÖ –§–æ—Ä–º–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç
- ‚úÖ –ê–¥–º–∏–Ω–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –∫–ª—é—á–æ–º
- ‚úÖ –û–±–∞ —Å–µ—Ä–≤–∏—Å–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è V2Ray —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API.

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞  
**–í–µ—Ä—Å–∏—è**: 2.0.1  
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: ~10 –º–∏–Ω—É—Ç  
**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º 