# Исправление таймаута для синхронизации ключей

## Проблема

При синхронизации ключей в админке возникала ошибка:
```
504 Gateway Time-out
```

## Причина

Nginx имел таймаут `proxy_read_timeout: 60s` (60 секунд), но синхронизация ключей может занимать до 10 минут (600 секунд), особенно при работе с медленными серверами.

## Решение

Добавлен специальный `location` блок для эндпоинта `/subscriptions/sync-keys` с увеличенными таймаутами:

```nginx
# Специальный location для синхронизации ключей (долгая операция - до 10 минут)
location /subscriptions/sync-keys {
    proxy_pass http://127.0.0.1:8001;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    
    # Увеличенные таймауты для синхронизации (10 минут = 600 секунд)
    proxy_connect_timeout 60s;
    proxy_send_timeout 600s;
    proxy_read_timeout 600s;
    
    # Отключаем буферизацию для длительных операций
    proxy_buffering off;
}
```

## Изменения

### Таймауты:
- **proxy_connect_timeout:** 60s (без изменений)
- **proxy_send_timeout:** 60s → **600s** (увеличено до 10 минут)
- **proxy_read_timeout:** 60s → **600s** (увеличено до 10 минут)

### Буферизация:
- **proxy_buffering:** on → **off** (отключена для длительных операций)

## Где применено

Специальный location добавлен в:
1. ✅ HTTPS блок для домена `veil-bot.ru`
2. ✅ HTTP блоки для всех IP адресов (46.151.31.105, 77.246.105.29, 212.118.52.195)

## Соответствие с кодом

Код админки уже настроен на таймаут 10 минут:
```python
timeout=600.0,  # 10 минут максимум
```

Теперь nginx также поддерживает этот таймаут.

## Результат

✅ Синхронизация ключей теперь может выполняться до 10 минут без ошибки 504 Gateway Timeout

## Проверка

После применения изменений синхронизация ключей должна работать без ошибок таймаута.
